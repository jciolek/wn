/*!*
 * WebNicer (WN) JavaScript Library v1.0.4
 * http://bitbucket.org/jciolek/webnicer
 *
 * @preserve
 * @author Jacek Ciolek <j.ciolek@webnicer.com>
 * @licence Copyright 2012-2013, Jacek Ciolek
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://bitbucket.org/jciolek/webnicer/wiki/Licence
 */
(function(f){function c(){var h,g=function(j,i){return g.ns(j,i)};for(h in c){if(c.hasOwnProperty(h)){g[h]=c[h]}}g.nsObj={};g.loader=new a();return g}c.extend=function d(s,m,q,k){var q=q||false,k=k||false,l=typeof s,h=typeof m,j={object:true,"function":true},r=function(){},g,o,n;if(!(h in j&&l in j)){throw new TypeError("WN::extend(): Type mismatch. Trying to extend "+l+" with "+h+".")}if(s===null||m===null){throw new TypeError("WN::extend(): child and parent cannot be null.")}for(g in m){if(m.hasOwnProperty(g)){o=m[g];n=s[g];if(!q||o===null||typeof o!=="object"){s[g]=o;continue}if(k||!(typeof n in j)){r.prototype=o.constructor.prototype;n=new r()}s[g]=d(n,o,q,k)}}return s};c.extend(c,{nsObj:null,loader:null,sandbox:c,require:function(j,h){var i=new e(h),g;if(typeof j==="string"){j=[j]}if(!(j instanceof Array)){throw new TypeError("WN::require(): nsArr parameter is expected to be a String or an Array. "+typeof ns+" given.")}if(h!==undefined&&typeof h!=="function"){throw new TypeError("WN::require(): callback parameter is expected to be a Function. "+typeof h+" given.")}while(g=j.shift()){if(this.ns(g)==undefined){if(g.charAt(0)!=="."){g="."+g}i.add(g)}}if(!i.finish()){this.loader.request(i)}},ns:function(q,n){var m=[],s=0,k=0,t,r=this.nsObj,g=r,u=(n===undefined),o=true,h=false,v="",p="";if(typeof q!="string"||q.length==0){throw new TypeError("WN::ns(): nsStr parameter is expected to be a non-zero length String. "+typeof q+': "'+q+'" given.')}if(q.charAt(0)!=="."){q="."+q}if(u){return g[q]}if(q.charAt(q.length-1)=="."){o=false;q=q.substr(0,q.length-1)}if(!o&&(typeof n!="object"||n instanceof Array)){throw new TypeError("WN::ns(): obj parameter is expected to be a non-Array Object, "+typeof n+" given.")}m=q.split(".");for(k=0,s=m.length;k<s;k++){h=(s-1<=k);v=m[k]+(!h||!o?".":"");p+=v;if(g[v]===undefined){if(!h||!o){r[p]=g[v]={}}}if(h){if(!o){for(t in n){if(n.hasOwnProperty(t)&&n[t]!=undefined){g[v][t]=n[t];r[p+t]=n[t];this.loader.notify(p+t)}}}else{r[p]=g[v]=n}this.loader.notify(p)}g=g[v]}return g},inherit:(function(){var g=function(){};return function(l,k,h){h=h||false;if(typeof k==="string"){k=this.ns(k)}if(typeof l!=="function"){throw new TypeError("WN::inherit(): C parameter is expected to be a function, "+typeof l+" given.")}if(typeof k!=="function"){throw new TypeError("WN::inherit(): P parameter is expected to be a function, "+typeof k+" given.")}var j=k.prototype,i=l.prototype;g.prototype=j;l.prototype=new g();this.extend(l.prototype,i);l.prototype.constructor=l;l.prototype.parent=j;if(h){this.extend(l,k)}l.parent=k}})()});function a(){this.required={};this.requested={};this.nsMapping={}}c.extend(a.prototype,{urlPrefix:"/js/",urlSuffix:".js",ns2url:function(g){return this.urlPrefix+g.replace(/^\./,"").replace(/\.$/,"_").replace(/\./g,"/")+this.urlSuffix},addMapping:function(i,h,g){if(typeof i!=="string"||i.length===0||i==="."){throw new TypeError("WN::addMapping(): ns parameter is expected to be a non-zero length string. "+typeof i+': "'+i+'" + given.')}if(i.charAt(0)!=="."){i="."+i}this.nsMapping[i]=new b(h,g)},request:function(m){var g=this,l,n,k=m.nsObj,j,h,i;for(j in k){h=this.nsMapping[j]||new b(this.ns2url(j));i=h.url;if(this.requested[i]===true){m.del(j);continue}if(this.required[j]===undefined){this.required[j]=[]}this.required[j].push(m);if(this.requested[i]===undefined){this.requested[i]=false;l=document.createElement("script");l.type="text/javascript";l.src=i;l.async=true;if(h.noNs){l.onload=(function(){var p=j,o=i;return function(q){g.requested[o]=true;g.notify.call(g,p)}})();l.onreadystatechange=(function(){var o=l;return function(){if(o.readyState==="loaded"||o.readyState==="complete"){o.onreadystatechange=null;o.onload()}}})()}n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(l,n)}}return m.finish()},notify:function(g){var i,h;i=this.required[g];if(i!==undefined){while(h=i.shift()){h.del(g);h.finish()}delete this.required[g]}}});function b(h,g){if(typeof h!=="string"||h.length==0){throw new TypeError("RequestURL(): url parameter is expected to be a non-zero length string. "+typeof h+': "'+h+'" given.')}this.url=h||"";this.noNs=Boolean(g||false)}function e(g){this.nsObj={};this.callback=g}c.extend(e.prototype,{nsObj:null,callback:null,finished:false,length:0,del:function(h){var g=false;if(this.nsObj.hasOwnProperty(h)){delete this.nsObj[h];this.length--;g=true}return g},add:function(h){var g=false;if(this.fihised){throw new Error("Request::add(): tried to add the namespace "+h+" to finished Request.")}if(!this.nsObj.hasOwnProperty(h)){this.nsObj[h]=null;this.length++;g=true}return g},finish:function(){if(!this.finished&&this.length==0){if(typeof this.callback==="function"){setTimeout(this.callback,0)}this.finished=true}return this.finished}});f.wn=c.sandbox()})(window);