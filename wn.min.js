/*!*
 * WebNicer (WN) JavaScript Library v1.0.4
 * http://bitbucket.org/jciolek/webnicer
 *
 * @preserve
 * @author Jacek Ciolek <j.ciolek@webnicer.com>
 * @licence Copyright 2012-2013, Jacek Ciolek
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://bitbucket.org/jciolek/webnicer/wiki/Licence
 */
(function(b){function a(){var g,h=function(i,j){return h.ns(i,j)};a.extend(h,a);h.nsObj={};h.loader=new d();return h}a.extend=function e(g,n,q,m){q=q||false;m=m||false;var r=typeof g,s=typeof n,j={object:true,"function":true},o=function(){},t,h,l;if(!(s in j&&r in j)){throw new TypeError("WN::extend(): Type mismatch. Trying to extend "+r+" with "+s+".")}if(g===null||n===null){throw new TypeError("WN::extend(): child and parent cannot be null.")}for(t in n){if(n.hasOwnProperty(t)){h=n[t];l=g[t];if(!q||h===null||!(typeof h in j)){g[t]=h;continue}if(m||!(typeof l in j)){if(typeof h==="function"){l=(function(){var i=h.__wnCloneOf||h,p=function(){return i.apply(this,arguments)};p.__wnCloneOf=i;return p})()}else{try{l=new h.constructor()}catch(k){o.prototype=h.constructor.prototype;l=new o()}}}g[t]=e(l,h,q,m)}}return g};a.extend(a,{nsObj:null,loader:null,sandbox:a,require:function(i,h){var g=new c(h),j;if(typeof i==="string"){i=[i]}if(!(i instanceof Array)){throw new TypeError("WN::require(): nsArr parameter is expected to be a String or an Array. "+typeof ns+" given.")}if(h!==undefined&&typeof h!=="function"){throw new TypeError("WN::require(): callback parameter is expected to be a Function. "+typeof h+" given.")}while(j=i.shift()){if(this.ns(j)==undefined){if(j.charAt(0)!=="."){j="."+j}g.add(j)}}if(!g.finish()){this.loader.request(g)}},ns:function(t,u){var h=[],o=0,v=0,m,g=this.nsObj,p=g,q=(u===undefined),k=true,n=false,s="",r="";if(typeof t!="string"||t.length===0){throw new TypeError("WN::ns(): nsStr parameter is expected to be a non-zero length String. "+typeof t+': "'+t+'" given.')}if(t.charAt(0)!=="."){t="."+t}if(q){return p[t]}if(t.charAt(t.length-1)=="."){k=false;t=t.substr(0,t.length-1)}if(!k&&(typeof u!="object"||u instanceof Array)){throw new TypeError("WN::ns(): obj parameter is expected to be a non-Array Object, "+typeof u+" given.")}h=t.split(".");for(v=0,o=h.length;v<o;v++){n=(o-1<=v);s=h[v]+(!n||!k?".":"");r+=s;if(p[s]===undefined){if(!n||!k){g[r]=p[s]={}}}if(n){if(!k){for(m in u){if(u.hasOwnProperty(m)&&u[m]!==undefined){p[s][m]=u[m];g[r+m]=u[m];this.loader.notify(r+m)}}}else{g[r]=p[s]=u}this.loader.notify(r)}p=p[s]}return p},inherit:(function(){var g=function(){};return function(i,l,k){k=k||false;if(typeof l==="string"){l=this.ns(l)}if(typeof i!=="function"){throw new TypeError("WN::inherit(): C parameter is expected to be a function, "+typeof i+" given.")}if(typeof l!=="function"){throw new TypeError("WN::inherit(): P parameter is expected to be a function, "+typeof l+" given.")}var j=l.prototype,h=i.prototype;g.prototype=j;i.prototype=new g();this.extend(i.prototype,h);i.prototype.constructor=i;i.prototype.parent=j;if(k){this.extend(i,l)}i.parent=l}})()});function d(){this.required={};this.requested={};this.nsMapping={}}a.extend(d.prototype,{urlPrefix:"/js/",urlSuffix:".js",ns2url:function(g){return this.urlPrefix+g.replace(/^\./,"").replace(/\.$/,"_").replace(/\./g,"/")+this.urlSuffix},addMapping:function(g,h,i){if(typeof g!=="string"||g.length===0||g==="."){throw new TypeError("WN::addMapping(): ns parameter is expected to be a non-zero length string. "+typeof g+': "'+g+'" + given.')}if(g.charAt(0)!=="."){g="."+g}this.nsMapping[g]=new f(h,i)},request:function(m){var l=this,n,k,i=m.nsObj,h,g,j;for(h in i){g=this.nsMapping[h]||new f(this.ns2url(h));j=g.url;if(this.requested[j]===true){m.del(h);continue}if(this.required[h]===undefined){this.required[h]=[]}this.required[h].push(m);if(this.requested[j]===undefined){this.requested[j]=false;n=document.createElement("script");n.type="text/javascript";n.src=j;n.async=true;if(g.noNs){n.onload=(function(){var p=h,o=j;return function(q){l.requested[o]=true;l.notify.call(l,p)}})();n.onreadystatechange=(function(){var o=n;return function(){if(o.readyState==="loaded"||o.readyState==="complete"){o.onreadystatechange=null;o.onload()}}})()}k=document.getElementsByTagName("script")[0];k.parentNode.insertBefore(n,k)}}return m.finish()},notify:function(i){var g,h;g=this.required[i];if(g!==undefined){while(h=g.shift()){h.del(i);h.finish()}delete this.required[i]}}});function f(g,h){if(typeof g!=="string"||g.length===0){throw new TypeError("RequestURL(): url parameter is expected to be a non-zero length string. "+typeof g+': "'+g+'" given.')}this.url=g||"";this.noNs=Boolean(h||false)}function c(g){this.nsObj={};this.callback=g}a.extend(c.prototype,{nsObj:null,callback:null,finished:false,length:0,del:function(g){var h=false;if(this.nsObj.hasOwnProperty(g)){delete this.nsObj[g];this.length--;h=true}return h},add:function(g){var h=false;if(this.fihised){throw new Error("Request::add(): tried to add the namespace "+g+" to finished Request.")}if(!this.nsObj.hasOwnProperty(g)){this.nsObj[g]=null;this.length++;h=true}return h},finish:function(){if(!this.finished&&this.length===0){if(typeof this.callback==="function"){setTimeout(this.callback,0)}this.finished=true}return this.finished}});b.wn=a.sandbox()})(window);