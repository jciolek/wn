/*!*
 * WebNicer (WN) JavaScript Library v1.0.3
 * http://bitbucket.org/jciolek/webnicer
 *
 * @preserve
 * @author Jacek Ciolek <j.ciolek@webnicer.com>
 * @licence Copyright 2012-2013, Jacek Ciolek
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://bitbucket.org/jciolek/webnicer/wiki/Licence
 */
(function(d){function c(){var h,g=function(i,j){return g.ns(i,j)};for(h in c){if(c.hasOwnProperty(h)){g[h]=c[h]}}g.nsObj={};g.loader=new e();return g}c.extend=function f(h,q,r,n){var r=r||false,n=n||false,m=typeof h,j=typeof q,k={object:true,"function":true},s=function(){},l,g,o;if(!(j in k&&m in k)){throw new TypeError("WN::extend(): Type mismatch. Trying to extend "+m+" with "+j+".")}if(h===null||q===null){throw new TypeError("WN::extend(): child and parent cannot be null.")}for(l in q){if(n||q.hasOwnProperty(l)){g=q[l];o=h[l];if(!r||g===null||typeof g!=="object"){h[l]=g;continue}s.prototype=g.constructor.prototype;o=new s();h[l]=f(o,g,r,n)}}return h};c.extend(c,{nsObj:null,loader:null,sandbox:c,require:function(h,j){var i=new b(j),g;if(typeof h==="string"){h=[h]}if(!(h instanceof Array)){throw new TypeError("WN::require(): nsArr parameter is expected to be a String or an Array. "+typeof ns+" given.")}if(j!==undefined&&typeof j!=="function"){throw new TypeError("WN::require(): callback parameter is expected to be a Function. "+typeof j+" given.")}while(g=h.shift()){if(this.ns(g)==undefined){if(g.charAt(0)!=="."){g="."+g}i.add(g)}}if(!i.finish()){this.loader.request(i)}},ns:function(n,r){var v=[],o=0,s=0,p,k=this.nsObj,u=k,h=(r===undefined),m=true,q=false,g="",t="";if(typeof n!="string"||n.length==0){throw new TypeError("WN::ns(): nsStr parameter is expected to be a non-zero length String. "+typeof n+': "'+n+'" given.')}if(n.charAt(0)!=="."){n="."+n}if(h){return u[n]}if(n.charAt(n.length-1)=="."){m=false;n=n.substr(0,n.length-1)}if(!m&&(typeof r!="object"||r instanceof Array)){throw new TypeError("WN::ns(): obj parameter is expected to be a non-Array Object, "+typeof r+" given.")}v=n.split(".");for(s=0,o=v.length;s<o;s++){q=(o-1<=s);g=v[s]+(!q||!m?".":"");t+=g;if(u[g]===undefined){if(!q||!m){k[t]=u[g]={}}}if(q){if(!m){for(p in r){if(r.hasOwnProperty(p)&&r[p]!=undefined){u[g][p]=r[p];k[t+p]=r[p];this.loader.notify(t+p)}}}else{k[t]=u[g]=r}this.loader.notify(t)}u=u[g]}return u},inherit:(function(){var g=function(){};return function(k,j,l){l=l||false;if(typeof j==="string"){j=this.ns(j)}if(typeof k!=="function"){throw new TypeError("WN::inherit(): C parameter is expected to be a function, "+typeof k+" given.")}if(typeof j!=="function"){throw new TypeError("WN::inherit(): P parameter is expected to be a function, "+typeof j+" given.")}var i=j.prototype,h=k.prototype;g.prototype=i;k.prototype=new g();this.extend(k.prototype,h);k.prototype.constructor=k;k.prototype.parent=i;if(l){this.extend(k,j)}k.parent=j}})()});function e(){this.required={};this.requested={};this.nsMapping={}}c.extend(e.prototype,{urlPrefix:"/js/",urlSuffix:".js",ns2url:function(g){return this.urlPrefix+g.replace(/^\./,"").replace(/\.$/,"_").replace(/\./g,"/")+this.urlSuffix},addMapping:function(i,h,g){if(typeof i!=="string"||i.length===0||i==="."){throw new TypeError("WN::addMapping(): ns parameter is expected to be a non-zero length string. "+typeof i+': "'+i+'" + given.')}if(i.charAt(0)!=="."){i="."+i}this.nsMapping[i]=new a(h,g)},request:function(l){var n=this,i,h,g=l.nsObj,k,m,j;for(k in g){m=this.nsMapping[k]||new a(this.ns2url(k));j=m.url;if(this.requested[j]===true){l.del(k);continue}if(this.required[k]===undefined){this.required[k]=[]}this.required[k].push(l);if(this.requested[j]===undefined){this.requested[j]=false;i=document.createElement("script");i.type="text/javascript";i.src=j;i.async=true;if(m.noNs){i.onload=(function(){var p=k,o=j;return function(q){n.requested[o]=true;n.notify.call(n,p)}})();i.onreadystatechange=(function(){var o=i;return function(){if(o.readyState==="loaded"||o.readyState==="complete"){o.onreadystatechange=null;o.onload()}}})()}h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(i,h)}}return l.finish()},notify:function(i){var h,g;h=this.required[i];if(h!==undefined){while(g=h.shift()){g.del(i);g.finish()}delete this.required[i]}}});function a(h,g){if(typeof h!=="string"||h.length==0){throw new TypeError("RequestURL(): url parameter is expected to be a non-zero length string. "+typeof h+': "'+h+'" given.')}this.url=h||"";this.noNs=Boolean(g||false)}function b(g){this.nsObj={};this.callback=g}c.extend(b.prototype,{nsObj:null,callback:null,finished:false,length:0,del:function(h){var g=false;if(this.nsObj.hasOwnProperty(h)){delete this.nsObj[h];this.length--;g=true}return g},add:function(h){var g=false;if(this.fihised){throw new Error("Request::add(): tried to add the namespace "+h+" to finished Request.")}if(!this.nsObj.hasOwnProperty(h)){this.nsObj[h]=null;this.length++;g=true}return g},finish:function(){if(!this.finished&&this.length==0){if(typeof this.callback==="function"){setTimeout(this.callback,0)}this.finished=true}return this.finished}});d.wn=c.sandbox()})(window);