/*!*
 * WebNicer (WN) JavaScript Library v1.0.4
 * http://bitbucket.org/jciolek/webnicer
 *
 * @preserve
 * @author Jacek Ciolek <j.ciolek@webnicer.com>
 * @licence Copyright 2012-2013, Jacek Ciolek
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://bitbucket.org/jciolek/webnicer/wiki/Licence
 */
(function(d){function f(){var g,h=function(j,i){return h.ns(j,i)};f.extend(h,f);h.nsObj={};h.loader=new b();return h}f.extend=function a(h,n,m,r){m=m||false;r=r||false;var g=typeof h,j=typeof n,l={object:true,"function":true},q=function(){},t,k,s;if(!(j in l&&g in l)){throw new TypeError("WN::extend(): Type mismatch. Trying to extend "+g+" with "+j+".")}if(h===null||n===null){throw new TypeError("WN::extend(): child and parent cannot be null.")}for(t in n){if(n.hasOwnProperty(t)){k=n[t];s=h[t];if(!m||k===null||!(typeof k in l)){h[t]=k;continue}if(r||!(typeof s in l)){if(typeof k==="function"){s=(function(){var p=k.__wnCloneOf||k,i=function(){return p.apply(this,arguments)};i.__wnCloneOf=p;return i})()}else{try{s=new k.constructor()}catch(o){q.prototype=k.constructor.prototype;s=new q()}}}h[t]=a(s,k,m,r)}}return h};f.extend(f,{nsObj:null,loader:null,sandbox:f,require:function(j,i){var h=new e(i),g;if(typeof j==="string"){j=[j]}if(!(j instanceof Array)){throw new TypeError("WN::require(): nsArr parameter is expected to be a String or an Array. "+typeof ns+" given.")}if(i!==undefined&&typeof i!=="function"){throw new TypeError("WN::require(): callback parameter is expected to be a Function. "+typeof i+" given.")}while(g=j.shift()){if(this.ns(g)==undefined){if(g.charAt(0)!=="."){g="."+g}h.add(g)}}if(!h.finish()){this.loader.request(h)}},ns:function(v,p){var g=[],k=0,t=0,m,u=this.nsObj,h=u,s=(p===undefined),n=true,o=false,r="",q="";if(typeof v!="string"||v.length===0){throw new TypeError("WN::ns(): nsStr parameter is expected to be a non-zero length String. "+typeof v+': "'+v+'" given.')}if(v.charAt(0)!=="."){v="."+v}if(s){return h[v]}if(v.charAt(v.length-1)=="."){n=false;v=v.substr(0,v.length-1)}if(!n&&(typeof p!="object"||p instanceof Array)){throw new TypeError("WN::ns(): obj parameter is expected to be a non-Array Object, "+typeof p+" given.")}g=v.split(".");for(t=0,k=g.length;t<k;t++){o=(k-1<=t);r=g[t]+(!o||!n?".":"");q+=r;if(h[r]===undefined){if(!o||!n){u[q]=h[r]={}}}if(o){if(!n){for(m in p){if(p.hasOwnProperty(m)&&p[m]!==undefined){h[r][m]=p[m];u[q+m]=p[m];this.loader.notify(q+m)}}}else{u[q]=h[r]=p}this.loader.notify(q)}h=h[r]}return h},inherit:(function(){var g=function(){};return function(k,i,h){h=h||false;if(typeof i==="string"){i=this.ns(i)}if(typeof k!=="function"){throw new TypeError("WN::inherit(): C parameter is expected to be a function, "+typeof k+" given.")}if(typeof i!=="function"){throw new TypeError("WN::inherit(): P parameter is expected to be a function, "+typeof i+" given.")}var l=i.prototype,j=k.prototype;g.prototype=l;k.prototype=new g();this.extend(k.prototype,j);k.prototype.constructor=k;k.prototype.parent=l;if(h){this.extend(k,i)}k.parent=i}})()});function b(){this.required={};this.requested={};this.nsMapping={}}f.extend(b.prototype,{urlPrefix:"/js/",urlSuffix:".js",ns2url:function(g){return this.urlPrefix+g.replace(/^\./,"").replace(/\.$/,"_").replace(/\./g,"/")+this.urlSuffix},addMapping:function(i,g,h){if(typeof i!=="string"||i.length===0||i==="."){throw new TypeError("WN::addMapping(): ns parameter is expected to be a non-zero length string. "+typeof i+': "'+i+'" + given.')}if(i.charAt(0)!=="."){i="."+i}this.nsMapping[i]=new c(g,h)},request:function(j){var k=this,i,h,l=j.nsObj,m,n,g;for(m in l){n=this.nsMapping[m]||new c(this.ns2url(m));g=n.url;if(this.requested[g]===true){j.del(m);continue}if(this.required[m]===undefined){this.required[m]=[]}this.required[m].push(j);if(this.requested[g]===undefined){this.requested[g]=false;i=document.createElement("script");i.type="text/javascript";i.src=g;i.async=true;if(n.noNs){i.onload=(function(){var p=m,o=g;return function(q){k.requested[o]=true;k.notify.call(k,p)}})();i.onreadystatechange=(function(){var o=i;return function(){if(o.readyState==="loaded"||o.readyState==="complete"){o.onreadystatechange=null;o.onload()}}})()}h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(i,h)}}return j.finish()},notify:function(h){var i,g;i=this.required[h];if(i!==undefined){while(g=i.shift()){g.del(h);g.finish()}delete this.required[h]}}});function c(g,h){if(typeof g!=="string"||g.length===0){throw new TypeError("RequestURL(): url parameter is expected to be a non-zero length string. "+typeof g+': "'+g+'" given.')}this.url=g||"";this.noNs=Boolean(h||false)}function e(g){this.nsObj={};this.callback=g}f.extend(e.prototype,{nsObj:null,callback:null,finished:false,length:0,del:function(h){var g=false;if(this.nsObj.hasOwnProperty(h)){delete this.nsObj[h];this.length--;g=true}return g},add:function(h){var g=false;if(this.fihised){throw new Error("Request::add(): tried to add the namespace "+h+" to finished Request.")}if(!this.nsObj.hasOwnProperty(h)){this.nsObj[h]=null;this.length++;g=true}return g},finish:function(){if(!this.finished&&this.length===0){if(typeof this.callback==="function"){setTimeout(this.callback,0)}this.finished=true}return this.finished}});d.wn=f.sandbox()})(window);