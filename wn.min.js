/*!*
 * WebNicer (WN) JavaScript Library v1.0.4
 * http://bitbucket.org/jciolek/webnicer
 *
 * @preserve
 * @author Jacek Ciolek <j.ciolek@webnicer.com>
 * @licence Copyright 2012-2013, Jacek Ciolek
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://bitbucket.org/jciolek/webnicer/wiki/Licence
 */
(function(a){function b(){var h,g=function(j,i){return g.ns(j,i)};b.extend(g,b);g.nsObj={};g.loader=new c();return g}b.extend=function f(k,h,n,q){var n=n||false,q=q||false,s=typeof k,j=typeof h,l={object:true,"function":true},o=function(){},m,g,r;if(!(j in l&&s in l)){throw new TypeError("WN::extend(): Type mismatch. Trying to extend "+s+" with "+j+".")}if(k===null||h===null){throw new TypeError("WN::extend(): child and parent cannot be null.")}for(m in h){if(h.hasOwnProperty(m)){g=h[m];r=k[m];if(!n||g===null||!(typeof g in l)){k[m]=g;continue}if(q||!(typeof r in l)){if(typeof g==="function"){r=(function(){var p=g.__wnCloneOf||g,i=function(){return p.apply(this,arguments)};i.__wnCloneOf=p;return i})()}else{o.prototype=g.constructor.prototype;r=new o()}}k[m]=f(r,g,n,q)}}return k};b.extend(b,{nsObj:null,loader:null,sandbox:b,require:function(j,h){var i=new e(h),g;if(typeof j==="string"){j=[j]}if(!(j instanceof Array)){throw new TypeError("WN::require(): nsArr parameter is expected to be a String or an Array. "+typeof ns+" given.")}if(h!==undefined&&typeof h!=="function"){throw new TypeError("WN::require(): callback parameter is expected to be a Function. "+typeof h+" given.")}while(g=j.shift()){if(this.ns(g)==undefined){if(g.charAt(0)!=="."){g="."+g}i.add(g)}}if(!i.finish()){this.loader.request(i)}},ns:function(o,n){var k=[],m=0,p=0,s,q=this.nsObj,g=q,h=(n===undefined),r=true,u=false,t="",v="";if(typeof o!="string"||o.length==0){throw new TypeError("WN::ns(): nsStr parameter is expected to be a non-zero length String. "+typeof o+': "'+o+'" given.')}if(o.charAt(0)!=="."){o="."+o}if(h){return g[o]}if(o.charAt(o.length-1)=="."){r=false;o=o.substr(0,o.length-1)}if(!r&&(typeof n!="object"||n instanceof Array)){throw new TypeError("WN::ns(): obj parameter is expected to be a non-Array Object, "+typeof n+" given.")}k=o.split(".");for(p=0,m=k.length;p<m;p++){u=(m-1<=p);t=k[p]+(!u||!r?".":"");v+=t;if(g[t]===undefined){if(!u||!r){q[v]=g[t]={}}}if(u){if(!r){for(s in n){if(n.hasOwnProperty(s)&&n[s]!=undefined){g[t][s]=n[s];q[v+s]=n[s];this.loader.notify(v+s)}}}else{q[v]=g[t]=n}this.loader.notify(v)}g=g[t]}return g},inherit:(function(){var g=function(){};return function(j,i,l){l=l||false;if(typeof i==="string"){i=this.ns(i)}if(typeof j!=="function"){throw new TypeError("WN::inherit(): C parameter is expected to be a function, "+typeof j+" given.")}if(typeof i!=="function"){throw new TypeError("WN::inherit(): P parameter is expected to be a function, "+typeof i+" given.")}var h=i.prototype,k=j.prototype;g.prototype=h;j.prototype=new g();this.extend(j.prototype,k);j.prototype.constructor=j;j.prototype.parent=h;if(l){this.extend(j,i)}j.parent=i}})()});function c(){this.required={};this.requested={};this.nsMapping={}}b.extend(c.prototype,{urlPrefix:"/js/",urlSuffix:".js",ns2url:function(g){return this.urlPrefix+g.replace(/^\./,"").replace(/\.$/,"_").replace(/\./g,"/")+this.urlSuffix},addMapping:function(h,i,g){if(typeof h!=="string"||h.length===0||h==="."){throw new TypeError("WN::addMapping(): ns parameter is expected to be a non-zero length string. "+typeof h+': "'+h+'" + given.')}if(h.charAt(0)!=="."){h="."+h}this.nsMapping[h]=new d(i,g)},request:function(n){var h=this,m,g,k=n.nsObj,i,j,l;for(i in k){j=this.nsMapping[i]||new d(this.ns2url(i));l=j.url;if(this.requested[l]===true){n.del(i);continue}if(this.required[i]===undefined){this.required[i]=[]}this.required[i].push(n);if(this.requested[l]===undefined){this.requested[l]=false;m=document.createElement("script");m.type="text/javascript";m.src=l;m.async=true;if(j.noNs){m.onload=(function(){var p=i,o=l;return function(q){h.requested[o]=true;h.notify.call(h,p)}})();m.onreadystatechange=(function(){var o=m;return function(){if(o.readyState==="loaded"||o.readyState==="complete"){o.onreadystatechange=null;o.onload()}}})()}g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(m,g)}}return n.finish()},notify:function(g){var h,i;h=this.required[g];if(h!==undefined){while(i=h.shift()){i.del(g);i.finish()}delete this.required[g]}}});function d(h,g){if(typeof h!=="string"||h.length==0){throw new TypeError("RequestURL(): url parameter is expected to be a non-zero length string. "+typeof h+': "'+h+'" given.')}this.url=h||"";this.noNs=Boolean(g||false)}function e(g){this.nsObj={};this.callback=g}b.extend(e.prototype,{nsObj:null,callback:null,finished:false,length:0,del:function(h){var g=false;if(this.nsObj.hasOwnProperty(h)){delete this.nsObj[h];this.length--;g=true}return g},add:function(h){var g=false;if(this.fihised){throw new Error("Request::add(): tried to add the namespace "+h+" to finished Request.")}if(!this.nsObj.hasOwnProperty(h)){this.nsObj[h]=null;this.length++;g=true}return g},finish:function(){if(!this.finished&&this.length==0){if(typeof this.callback==="function"){setTimeout(this.callback,0)}this.finished=true}return this.finished}});a.wn=b.sandbox()})(window);