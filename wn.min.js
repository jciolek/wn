/*!*
 * WebNicer (WN) JavaScript Library v1.0.4
 * http://bitbucket.org/jciolek/webnicer
 *
 * @preserve
 * @author Jacek Ciolek <j.ciolek@webnicer.com>
 * @licence Copyright 2012-2013, Jacek Ciolek
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://bitbucket.org/jciolek/webnicer/wiki/Licence
 */
(function(c){function b(){var g,h=function(j,i){return h.ns(j,i)};b.extend(h,b);h.nsObj={};h.loader=new a();return h}b.extend=function e(j,l,o,s){o=o||false;s=s||false;var k=typeof j,q=typeof l,r={object:true,"function":true},n=function(){},h,g,m;if(!(q in r&&k in r)){throw new TypeError("WN::extend(): Type mismatch. Trying to extend "+k+" with "+q+".")}if(j===null||l===null){throw new TypeError("WN::extend(): child and parent cannot be null.")}for(h in l){if(l.hasOwnProperty(h)){g=l[h];m=j[h];if(!o||g===null||!(typeof g in r)){j[h]=g;continue}if(s||!(typeof m in r)){if(typeof g==="function"){m=(function(){var p=g.__wnCloneOf||g,i=function(){return p.apply(this,arguments)};i.__wnCloneOf=p;return i})()}else{n.prototype=g.constructor.prototype;m=new n()}}j[h]=e(m,g,o,s)}}return j};b.extend(b,{nsObj:null,loader:null,sandbox:b,require:function(j,g){var i=new f(g),h;if(typeof j==="string"){j=[j]}if(!(j instanceof Array)){throw new TypeError("WN::require(): nsArr parameter is expected to be a String or an Array. "+typeof ns+" given.")}if(g!==undefined&&typeof g!=="function"){throw new TypeError("WN::require(): callback parameter is expected to be a Function. "+typeof g+" given.")}while(h=j.shift()){if(this.ns(h)==undefined){if(h.charAt(0)!=="."){h="."+h}i.add(h)}}if(!i.finish()){this.loader.request(i)}},ns:function(q,p){var v=[],h=0,g=0,s,t=this.nsObj,r=t,u=(p===undefined),o=true,n=false,m="",k="";if(typeof q!="string"||q.length===0){throw new TypeError("WN::ns(): nsStr parameter is expected to be a non-zero length String. "+typeof q+': "'+q+'" given.')}if(q.charAt(0)!=="."){q="."+q}if(u){return r[q]}if(q.charAt(q.length-1)=="."){o=false;q=q.substr(0,q.length-1)}if(!o&&(typeof p!="object"||p instanceof Array)){throw new TypeError("WN::ns(): obj parameter is expected to be a non-Array Object, "+typeof p+" given.")}v=q.split(".");for(g=0,h=v.length;g<h;g++){n=(h-1<=g);m=v[g]+(!n||!o?".":"");k+=m;if(r[m]===undefined){if(!n||!o){t[k]=r[m]={}}}if(n){if(!o){for(s in p){if(p.hasOwnProperty(s)&&p[s]!==undefined){r[m][s]=p[s];t[k+s]=p[s];this.loader.notify(k+s)}}}else{t[k]=r[m]=p}this.loader.notify(k)}r=r[m]}return r},inherit:(function(){var g=function(){};return function(h,j,k){k=k||false;if(typeof j==="string"){j=this.ns(j)}if(typeof h!=="function"){throw new TypeError("WN::inherit(): C parameter is expected to be a function, "+typeof h+" given.")}if(typeof j!=="function"){throw new TypeError("WN::inherit(): P parameter is expected to be a function, "+typeof j+" given.")}var l=j.prototype,i=h.prototype;g.prototype=l;h.prototype=new g();this.extend(h.prototype,i);h.prototype.constructor=h;h.prototype.parent=l;if(k){this.extend(h,j)}h.parent=j}})()});function a(){this.required={};this.requested={};this.nsMapping={}}b.extend(a.prototype,{urlPrefix:"/js/",urlSuffix:".js",ns2url:function(g){return this.urlPrefix+g.replace(/^\./,"").replace(/\.$/,"_").replace(/\./g,"/")+this.urlSuffix},addMapping:function(i,g,h){if(typeof i!=="string"||i.length===0||i==="."){throw new TypeError("WN::addMapping(): ns parameter is expected to be a non-zero length string. "+typeof i+': "'+i+'" + given.')}if(i.charAt(0)!=="."){i="."+i}this.nsMapping[i]=new d(g,h)},request:function(k){var j=this,i,l,h=k.nsObj,m,n,g;for(m in h){n=this.nsMapping[m]||new d(this.ns2url(m));g=n.url;if(this.requested[g]===true){k.del(m);continue}if(this.required[m]===undefined){this.required[m]=[]}this.required[m].push(k);if(this.requested[g]===undefined){this.requested[g]=false;i=document.createElement("script");i.type="text/javascript";i.src=g;i.async=true;if(n.noNs){i.onload=(function(){var o=m,p=g;return function(q){j.requested[p]=true;j.notify.call(j,o)}})();i.onreadystatechange=(function(){var o=i;return function(){if(o.readyState==="loaded"||o.readyState==="complete"){o.onreadystatechange=null;o.onload()}}})()}l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(i,l)}}return k.finish()},notify:function(i){var h,g;h=this.required[i];if(h!==undefined){while(g=h.shift()){g.del(i);g.finish()}delete this.required[i]}}});function d(g,h){if(typeof g!=="string"||g.length===0){throw new TypeError("RequestURL(): url parameter is expected to be a non-zero length string. "+typeof g+': "'+g+'" given.')}this.url=g||"";this.noNs=Boolean(h||false)}function f(g){this.nsObj={};this.callback=g}b.extend(f.prototype,{nsObj:null,callback:null,finished:false,length:0,del:function(h){var g=false;if(this.nsObj.hasOwnProperty(h)){delete this.nsObj[h];this.length--;g=true}return g},add:function(h){var g=false;if(this.fihised){throw new Error("Request::add(): tried to add the namespace "+h+" to finished Request.")}if(!this.nsObj.hasOwnProperty(h)){this.nsObj[h]=null;this.length++;g=true}return g},finish:function(){if(!this.finished&&this.length===0){if(typeof this.callback==="function"){setTimeout(this.callback,0)}this.finished=true}return this.finished}});c.wn=b.sandbox()})(window);