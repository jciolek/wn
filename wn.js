/**
 * WebNicer (WN) JavaScript Library v1.0.0
 * http://bitbucket.org/jciolek/webnicer
 *
 * @author Jacek Ciolek <j.ciolek@webnicer.com>
 * @licence Copyright 2012, Jacek Ciolek
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://bitbucket.org/jciolek/webnicer/wiki/Licence
 */
(function(){function e(g,h){return e.ns(g,h)}e.extend=function f(h,o,q,m){var q=q||false,m=m||false,l=typeof h,j=typeof o,k,g,n;if((j!=="object"&&j!=="function")||(l!=="object"&&l!=="function")){throw new TypeError("WN::extend(): Type mismatch. Trying to extend "+l+" with "+j+".")}for(k in o){if(m||o.hasOwnProperty(k)){g=o[k];n=h[k];if(!q){if(g!==undefined||n===null){h[k]=g}continue}if(typeof g=="object"){if(g!==null){if(typeof n!="object"){n=(g instanceof Array)?[]:{}}h[k]=f(n,g,q,m)}else{if(n===undefined){h[k]=null}}}else{if(g!==undefined||n===null){h[k]=g}}}}return h};e.extend(e,{nsObj:{},loader:{required:{},requested:{},urlPrefix:"/",urlSuffix:".js",nsMapping:{},ns2url:function(g){return this.urlPrefix+g+this.urlSuffix},addMapping:function(i,h,g){if(typeof i!=="string"){throw new TypeError("WN::addMapping(): ns parameter is expected to be a string. "+typeof i+" given.")}this.nsMapping[i]=new a(h,g)},request:function(h){var m=this,l,k,o=h.nsObj,n,i,g,j;for(n in o){i=this.nsMapping[n]||new a(this.ns2url(n));g=i.url;if(this.requested[g]===true){h.del(n);continue}if(this.required[n]===undefined){this.required[n]=[]}this.required[n].push(h);if(this.requested[g]===undefined){this.requested[g]=false;l=document.createElement("script");l.type="text/javascript";l.src=g;l.async=true;if(i.noNs){l.onload=(function(){var q=n,p=g;return function(r){m.requested[p]=true;m.notify.call(m,q)}})();l.onreadystatechange=(function(){var p=l;_onloadHandler=j;return function(){if(p.readyState==="loaded"||p.readyState==="complete"){p.onreadystatechange=null;p.onload()}}})()}k=document.getElementsByTagName("script")[0];k.parentNode.insertBefore(l,k)}}return h.finish()},notify:function(i){var h,g;h=this.required[i];if(h!==undefined){while(g=h.shift()){g.del(i);g.finish()}delete this.required[i]}}},require:function b(h,j){var i=new c(j),g;if(typeof h==="string"){h=[h]}if(!(h instanceof Array)){throw new TypeError("WN::require(): nsArr parameter is expected to be a String or an Array. "+typeof d+" given.")}if(j!==undefined&&typeof j!=="function"){throw new TypeError("WN::require(): callback parameter is expected to be a Function. "+typeof j+" given.")}while(g=h.shift()){if(typeof g!=="string"||g.length==0){throw new TypeError("WN::require(): namespace is expected to be a non-zero length String. "+typeof g+': "'+g+'" given.')}if(this.nsObj[g]==undefined){i.add(g)}}if(!i.finish()){this.loader.request(i)}},ns:function d(n,r){var v=[],o=0,s=0,p,k=this.nsObj,u=k,h=(r===undefined),m=true,q=false,g="",t="";if(typeof n!="string"||n.length==0){throw new TypeError("WN::ns(): nsStr parameter is expected to be a non-zero length String. "+typeof n+': "'+n+'" given.')}if(n.charAt(0)!=="."){n="."+n}if(h){return u[n]||null}if(n.charAt(n.length-1)=="."){m=false;n=n.substr(0,n.length-1)}if(!m&&(typeof r!="object"||r instanceof Array)){throw new TypeError("WN::ns(): obj parameter is expected to be a non-Array Object, "+typeof r+" given.")}v=n.split(".");for(s=0,o=v.length;s<o;s++){q=(o-1<=s);g=v[s]+(!q||!m?".":"");t+=g;if(u[g]===undefined){if(!q||!m){k[t]=u[g]={}}}if(q){if(!m){for(p in r){if(r.hasOwnProperty(p)&&r[p]!=undefined){u[g][p]=r[p];k[t+p]=r[p]}}}else{k[t]=u[g]=r}}u=u[g]}this.loader.notify(n);return u},inherit:(function(){var h=function(){};return function g(n,m){if(typeof m==="string"){m=this.ns(m)}if(typeof n!=="function"){throw new TypeError("WN::inherit(): C parameter is expected to be a function, "+typeof n+" given.")}if(typeof m!=="function"){throw new TypeError("WN::inherit(): P parameter is expected to be a function, "+typeof m+" given.")}var k=m.prototype,j=n.prototype,l;h.prototype=k;n.prototype=new h();this.extend(n.prototype,j);n.prototype.constructor=n;n.prototype.parent=k;this.extend(n,m);n.parent=m}})()});function a(h,g){if(typeof h!=="string"||h.length==0){throw new TypeError("RequestURL(): url parameter is expected to be a non-zero length string. "+typeof h+': "'+h+'" given.')}this.url=h;this.noNs=Boolean(g||false)}e.extend(a.prototype,{url:"",noNs:false});function c(g){this.nsObj={};this.callback=g}e.extend(c.prototype,{nsObj:null,callback:null,finished:false,length:0,del:function(h){var g=false;if(this.nsObj.hasOwnProperty(h)){delete this.nsObj[h];this.length--;g=true}return g},add:function(h){var g=false;if(this.fihised){throw new Error("Request::add(): tried to add the namespace "+h+" to finished Request.")}if(!this.nsObj.hasOwnProperty(h)){this.nsObj[h]=null;this.length++;g=true}return g},finish:function(){if(!this.finished&&this.length==0){if(typeof this.callback==="function"){setTimeout(this.callback,0)}this.finished=true}return this.finished}});window.wn=e})();